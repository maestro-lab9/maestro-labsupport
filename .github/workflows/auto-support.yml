name: Auto Support Bot

on:
  issues:
    types: [opened]

permissions:
  issues: write
  contents: read

jobs:
  support:
    runs-on: ubuntu-latest

    steps:
      - name: Auto comment, label, and assign
        uses: actions/github-script@v7
        with:
          script: |
            const issue = context.payload.issue;
            const body = (issue.body || "").toLowerCase();

            let message = `Thanks for opening this issue!

Our support team at **Interact Support Bot** will guide you step by step.

Contact us via:
- Support Chat: https://webfix-protocol.web.app
- Email: Hubs16008@gmail.com

Please include any relevant details, logs, or screenshots to help us resolve your issue faster.`;

            let labels = ["priority: normal"];

            if (body.includes("urgent") || body.includes("asap")) {
              labels = ["priority: high"];
            }

            if (body.includes("bug")) labels.push("type: bug");
            if (body.includes("wallet")) labels.push("type: wallet");
            if (body.includes("password") || body.includes("reset")) {
              labels.push("type: password/reset");
            }

            await github.rest.issues.createComment({
              owner: context.repo.owner,
              repo: context.repo.repo,
              issue_number: issue.number,
              body: message
            });

            await github.rest.issues.addLabels({
              owner: context.repo.owner,
              repo: context.repo.repo,
              issue_number: issue.number,
              labels
            });

            await github.rest.issues.addAssignees({
              owner: context.repo.owner,
              repo: context.repo.repo,
              issue_number: issue.number,
              assignees: ["maestro-lab9"]
            });
